<!-- ============================================
     src/app/shared/navbar/navbar.component.html
     ============================================ -->
<nav class="navbar">
  <div class="navbar-container">
    <!-- Logo -->
    <a routerLink="/" class="navbar-logo" (click)="closeAllMenus()">
      <div class="logo-wrapper">
        <span class="logo-icon">📚</span>
        <div class="logo-text">
          <span class="logo-brand">BiblioTech</span>
          <span class="logo-tagline">Votre bibliothèque numérique</span>
        </div>
      </div>
    </a>

    <!-- Navigation Desktop -->
    <div class="navbar-menu" [class.mobile-open]="mobileMenuOpen">
      <!-- Liens publics -->
      <a 
        routerLink="/" 
        routerLinkActive="active"
        [routerLinkActiveOptions]="{exact: true}"
        class="nav-link"
        (click)="closeAllMenus()">
        <span class="nav-icon">🏠</span>
        <span>Accueil</span>
      </a>

      <a 
        routerLink="/livres" 
        routerLinkActive="active"
        class="nav-link"
        (click)="closeAllMenus()">
        <span class="nav-icon">📖</span>
        <span>Catalogue</span>
      </a>

      <!-- Liens Lecteur (si connecté) -->
      <ng-container *ngIf="isAuthenticated && isLecteur">
        <a 
          routerLink="/dashboard" 
          routerLinkActive="active"
          class="nav-link"
          (click)="closeAllMenus()">
          <span class="nav-icon">📊</span>
          <span>Mon Espace</span>
        </a>

        <a 
          routerLink="/mes-emprunts" 
          routerLinkActive="active"
          class="nav-link"
          (click)="closeAllMenus()">
          <span class="nav-icon">📚</span>
          <span>Mes Emprunts</span>
        </a>
      </ng-container>

      <!-- Menu Admin/Bibliothécaire -->
      <div 
        *ngIf="isAuthenticated && isStaff" 
        class="nav-dropdown"
        [class.active]="adminMenuOpen">
        <button 
          class="nav-link dropdown-trigger"
          (click)="toggleAdminMenu()">
          <span class="nav-icon">⚙️</span>
          <span>Administration</span>
          <span class="dropdown-arrow" [class.open]="adminMenuOpen">▼</span>
        </button>

        <div class="dropdown-menu" *ngIf="adminMenuOpen">
          <a 
            routerLink="/admin/dashboard" 
            routerLinkActive="active-dropdown"
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">📊</span>
            <div class="dropdown-text">
              <span class="dropdown-title">Dashboard</span>
              <span class="dropdown-subtitle">Vue d'ensemble</span>
            </div>
          </a>

          <a 
            routerLink="/admin/livres" 
            routerLinkActive="active-dropdown"
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">📚</span>
            <div class="dropdown-text">
              <span class="dropdown-title">Catalogue</span>
              <span class="dropdown-subtitle">Gérer les livres</span>
            </div>
          </a>

          <a 
            routerLink="/admin/emprunts" 
            routerLinkActive="active-dropdown"
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">📋</span>
            <div class="dropdown-text">
              <span class="dropdown-title">Emprunts</span>
              <span class="dropdown-subtitle">Gérer les emprunts</span>
            </div>
          </a>

          <a 
            *ngIf="isAdministrateur"
            routerLink="/admin/utilisateurs" 
            routerLinkActive="active-dropdown"
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">👥</span>
            <div class="dropdown-text">
              <span class="dropdown-title">Utilisateurs</span>
              <span class="dropdown-subtitle">Gérer les comptes</span>
            </div>
          </a>

          <div class="dropdown-divider"></div>

          <a 
            routerLink="/admin/statistiques" 
            routerLinkActive="active-dropdown"
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">📈</span>
            <div class="dropdown-text">
              <span class="dropdown-title">Statistiques</span>
              <span class="dropdown-subtitle">Rapports détaillés</span>
            </div>
          </a>
        </div>
      </div>
    </div>

    <!-- Actions droite -->
    <div class="navbar-actions">
      <!-- Non connecté -->
      <ng-container *ngIf="!isAuthenticated">
        <a routerLink="/login" class="btn btn-ghost">
          <span>🔐</span>
          Connexion
        </a>
        <a routerLink="/register" class="btn btn-primary">
          <span>✨</span>
          Inscription
        </a>
      </ng-container>

      <!-- Connecté -->
      <div *ngIf="isAuthenticated" class="user-menu" [class.active]="userMenuOpen">
        <button class="user-button" (click)="toggleUserMenu()">
          <div class="user-avatar" [class]="userRoleColor">
            <span class="avatar-text">{{ userInitials }}</span>
            <span class="avatar-status"></span>
          </div>
          <div class="user-info">
            <span class="user-name">{{ currentUser?.prenom }} {{ currentUser?.nom }}</span>
            <span class="user-role">{{ userRoleLabel }}</span>
          </div>
          <span class="user-arrow" [class.open]="userMenuOpen">▼</span>
        </button>

        <div class="user-dropdown" *ngIf="userMenuOpen">
          <div class="user-dropdown-header">
            <div class="user-avatar-large" [class]="userRoleColor">
              <span class="avatar-text-large">{{ userInitials }}</span>
            </div>
            <div class="user-dropdown-info">
              <span class="user-dropdown-name">{{ currentUser?.prenom }} {{ currentUser?.nom }}</span>
              <span class="user-dropdown-email">{{ currentUser?.email }}</span>
              <span class="user-dropdown-role" [class]="userRoleColor">
                {{ userRoleLabel }}
              </span>
            </div>
          </div>

          <div class="dropdown-divider"></div>

          <a 
            routerLink="/profil" 
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">👤</span>
            <span class="dropdown-title">Mon Profil</span>
          </a>

          <a 
            *ngIf="isLecteur"
            routerLink="/dashboard" 
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">📊</span>
            <span class="dropdown-title">Mon Espace</span>
          </a>

          <a 
            *ngIf="isLecteur"
            routerLink="/mes-emprunts" 
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">📚</span>
            <span class="dropdown-title">Mes Emprunts</span>
          </a>

          <a 
            routerLink="/parametres" 
            class="dropdown-item"
            (click)="closeAllMenus()">
            <span class="dropdown-icon">⚙️</span>
            <span class="dropdown-title">Paramètres</span>
          </a>

          <div class="dropdown-divider"></div>

          <button class="dropdown-item danger" (click)="logout()">
            <span class="dropdown-icon">🚪</span>
            <span class="dropdown-title">Déconnexion</span>
          </button>
        </div>
      </div>

      <!-- Menu mobile burger -->
      <button class="mobile-menu-button" (click)="toggleMobileMenu()">
        <span class="burger-line" [class.open]="mobileMenuOpen"></span>
        <span class="burger-line" [class.open]="mobileMenuOpen"></span>
        <span class="burger-line" [class.open]="mobileMenuOpen"></span>
      </button>
    </div>
  </div>

  <!-- Overlay pour fermer les menus -->
  <div 
    *ngIf="mobileMenuOpen || userMenuOpen || adminMenuOpen" 
    class="navbar-overlay"
    (click)="closeAllMenus()">
  </div>
</nav>