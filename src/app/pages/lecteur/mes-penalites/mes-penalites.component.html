<!-- ============================================
     src/app/pages/lecteur/mes-penalites/mes-penalites.component.html
     ============================================ -->
<div class="penalites-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="page-title">
          <span class="title-icon">ğŸ’°</span>
          Mes PÃ©nalitÃ©s
        </h1>
        <p class="page-subtitle">Consultez et gÃ©rez vos amendes de retard</p>
      </div>
      <button class="btn btn-primary" routerLink="/mes-emprunts">
        <span class="btn-icon">ğŸ“š</span>
        Mes Emprunts
      </button>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid" *ngIf="stats">
    <div class="stat-card orange">
      <div class="stat-icon">âš ï¸</div>
      <div class="stat-content">
        <div class="stat-value">{{ nombrePenalitesImpayees }}</div>
        <div class="stat-label">PÃ©nalitÃ©s ImpayÃ©es</div>
      </div>
      <div class="stat-glow"></div>
    </div>

    <div class="stat-card red">
      <div class="stat-icon">ğŸ’¸</div>
      <div class="stat-content">
        <div class="stat-value">{{ formatMontant(montantTotalImpaye) }}</div>
        <div class="stat-label">Montant Total Ã  Payer</div>
      </div>
      <div class="stat-glow"></div>
    </div>

    <div class="stat-card green">
      <div class="stat-icon">âœ…</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.penalites_payees || 0 }}</div>
        <div class="stat-label">PÃ©nalitÃ©s PayÃ©es</div>
      </div>
      <div class="stat-glow"></div>
    </div>

    <div class="stat-card blue">
      <div class="stat-icon">ğŸ“Š</div>
      <div class="stat-content">
        <div class="stat-value">{{ formatMontant(stats.montant_total_paye) }}</div>
        <div class="stat-label">Total PayÃ©</div>
      </div>
      <div class="stat-glow"></div>
    </div>
  </div>

  <!-- Alert si pÃ©nalitÃ©s impayÃ©es -->
  <div class="alert alert-warning" *ngIf="nombrePenalitesImpayees > 0">
    <span class="alert-icon">âš ï¸</span>
    <div class="alert-content">
      <strong>Attention !</strong> Vous avez {{ nombrePenalitesImpayees }} pÃ©nalitÃ©(s) impayÃ©e(s) 
      pour un montant total de <strong>{{ formatMontant(montantTotalImpaye) }}</strong>.
      <br>
      <small>Les pÃ©nalitÃ©s non payÃ©es peuvent bloquer vos futurs emprunts.</small>
    </div>
  </div>

  <!-- Alert si aucune pÃ©nalitÃ© -->
  <div class="alert alert-success" *ngIf="stats && stats.total_penalites === 0">
    <span class="alert-icon">ğŸ‰</span>
    <div class="alert-content">
      <strong>Excellent !</strong> Vous n'avez aucune pÃ©nalitÃ©. Continuez Ã  retourner vos livres Ã  temps !
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs-navigation">
    <button 
      class="tab-button"
      [class.active]="activeTab === 'impayees'"
      (click)="setActiveTab('impayees')">
      <span class="tab-icon">âš ï¸</span>
      <span>ImpayÃ©es</span>
      <span class="tab-badge" *ngIf="nombrePenalitesImpayees > 0">{{ nombrePenalitesImpayees }}</span>
    </button>

    <button 
      class="tab-button"
      [class.active]="activeTab === 'payees'"
      (click)="setActiveTab('payees')">
      <span class="tab-icon">âœ…</span>
      <span>PayÃ©es</span>
    </button>

    <button 
      class="tab-button"
      [class.active]="activeTab === 'toutes'"
      (click)="setActiveTab('toutes')">
      <span class="tab-icon">ğŸ“‹</span>
      <span>Toutes</span>
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Chargement des pÃ©nalitÃ©s...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !loading" class="error-message">
    <span class="error-icon">âš ï¸</span>
    <p>{{ error }}</p>
  </div>

  <!-- Liste des pÃ©nalitÃ©s -->
  <div *ngIf="!loading && !error" class="penalites-list">
    <div *ngIf="penalites.length === 0" class="empty-state">
      <span class="empty-icon">
        {{ activeTab === 'impayees' ? 'ğŸ‰' : activeTab === 'payees' ? 'ğŸ“‹' : 'ğŸ“„' }}
      </span>
      <h3>{{ activeTab === 'impayees' ? 'Aucune pÃ©nalitÃ© impayÃ©e' : 
              activeTab === 'payees' ? 'Aucune pÃ©nalitÃ© payÃ©e' : 
              'Aucune pÃ©nalitÃ©' }}</h3>
      <p>
        {{ activeTab === 'impayees' ? 'Continuez Ã  retourner vos livres Ã  temps !' : 
           activeTab === 'payees' ? 'Vous n\'avez pas encore payÃ© de pÃ©nalitÃ©.' : 
           'Vous n\'avez aucune pÃ©nalitÃ© enregistrÃ©e.' }}
      </p>
    </div>

    <div class="penalites-grid" *ngIf="penalites.length > 0">
      <div *ngFor="let penalite of penalites" class="penalite-card">
        <div class="penalite-header">
          <div class="penalite-badge" [ngClass]="getStatusClass(penalite.statut)">
            {{ getStatusLabel(penalite.statut) }}
          </div>
          <div class="penalite-montant">{{ formatMontant(penalite.montant) }}</div>
        </div>

        <div class="penalite-body">
          <div class="penalite-info">
            <span class="info-icon">ğŸ“–</span>
            <div class="info-content">
              <div class="info-label">Livre</div>
              <div class="info-value">{{ penalite.emprunt?.exemplaire?.livre?.titre || 'Non spÃ©cifiÃ©' }}</div>
            </div>
          </div>

          <div class="penalite-info">
            <span class="info-icon">ğŸ“</span>
            <div class="info-content">
              <div class="info-label">Motif</div>
              <div class="info-value">{{ penalite.motif }}</div>
            </div>
          </div>

          <div class="penalite-dates">
            <div class="date-item">
              <span class="date-icon">ğŸ“…</span>
              <div class="date-content">
                <div class="date-label">Date de crÃ©ation</div>
                <div class="date-value">{{ formatDate(penalite.date_creation) }}</div>
              </div>
            </div>

            <div class="date-item" *ngIf="penalite.date_paiement">
              <span class="date-icon">ğŸ’³</span>
              <div class="date-content">
                <div class="date-label">Date de paiement</div>
                <div class="date-value">{{ formatDate(penalite.date_paiement) }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="penalite-footer" *ngIf="penalite.statut === 'impayee'">
          <button class="btn btn-secondary btn-sm" disabled>
            <span class="btn-icon">ğŸ’³</span>
            Payer en ligne (BientÃ´t disponible)
          </button>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="totalPages > 1">
      <button 
        class="pagination-btn"
        [disabled]="currentPage === 1"
        (click)="changePage(currentPage - 1)">
        â† PrÃ©cÃ©dent
      </button>

      <div class="pagination-pages">
        <button 
          *ngFor="let page of [].constructor(totalPages); let i = index"
          class="pagination-page"
          [class.active]="currentPage === i + 1"
          (click)="changePage(i + 1)">
          {{ i + 1 }}
        </button>
      </div>

      <button 
        class="pagination-btn"
        [disabled]="currentPage === totalPages"
        (click)="changePage(currentPage + 1)">
        Suivant â†’
      </button>
    </div>
  </div>

  <!-- Info Section -->
  <div class="info-section">
    <h3 class="info-title">
      <span class="info-icon">ğŸ’¡</span>
      Ã€ savoir sur les pÃ©nalitÃ©s
    </h3>
    <div class="info-grid">
      <div class="info-card">
        <span class="info-emoji">â±ï¸</span>
        <h4>Calcul automatique</h4>
        <p>Les pÃ©nalitÃ©s sont calculÃ©es automatiquement chaque jour Ã  partir de la date de retour prÃ©vue.</p>
      </div>

      <div class="info-card">
        <span class="info-emoji">ğŸ’°</span>
        <h4>Tarif unique</h4>
        <p>Le tarif est de <strong>100 FCFA par jour de retard</strong> pour tous les emprunts.</p>
      </div>

      <div class="info-card">
        <span class="info-emoji">ğŸš«</span>
        <h4>Blocage des emprunts</h4>
        <p>Les pÃ©nalitÃ©s impayÃ©es peuvent bloquer vos nouveaux emprunts jusqu'au rÃ¨glement.</p>
      </div>

      <div class="info-card">
        <span class="info-emoji">ğŸ’³</span>
        <h4>Modes de paiement</h4>
        <p>Payez vos pÃ©nalitÃ©s directement au comptoir de la bibliothÃ¨que ou en ligne (bientÃ´t).</p>
      </div>
    </div>
  </div>
</div>