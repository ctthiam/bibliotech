<!-- ============================================
     src/app/pages/lecteur/mes-reservations/mes-reservations.component.html
     ============================================ -->
<div class="reservations-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="page-title">
          <span class="title-icon">ğŸ“š</span>
          Mes RÃ©servations
        </h1>
        <p class="page-subtitle">GÃ©rez vos rÃ©servations de livres</p>
      </div>
      <button class="btn btn-primary" routerLink="/livres">
        <span class="btn-icon">ğŸ”</span>
        Parcourir le Catalogue
      </button>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid" *ngIf="stats">
    <div class="stat-card blue">
      <div class="stat-icon">â³</div>
      <div class="stat-content">
        <div class="stat-value">{{ nombreEnAttente }}</div>
        <div class="stat-label">En Attente</div>
      </div>
      <div class="stat-glow"></div>
    </div>

    <div class="stat-card green">
      <div class="stat-icon">âœ…</div>
      <div class="stat-content">
        <div class="stat-value">{{ nombreDisponibles }}</div>
        <div class="stat-label">Disponibles</div>
      </div>
      <div class="stat-glow"></div>
    </div>

    <div class="stat-card purple">
      <div class="stat-icon">ğŸ“Š</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.total_reservations }}</div>
        <div class="stat-label">Total RÃ©servations</div>
      </div>
      <div class="stat-glow"></div>
    </div>

    <div class="stat-card orange">
      <div class="stat-icon">â°</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.reservations_expirees }}</div>
        <div class="stat-label">ExpirÃ©es</div>
      </div>
      <div class="stat-glow"></div>
    </div>
  </div>

  <!-- Alert si rÃ©servations disponibles -->
  <div class="alert alert-success" *ngIf="nombreDisponibles > 0">
    <span class="alert-icon">ğŸ‰</span>
    <div class="alert-content">
      <strong>Bonne nouvelle !</strong> Vous avez {{ nombreDisponibles }} livre(s) disponible(s) 
      pour emprunt. Passez Ã  la bibliothÃ¨que pour les rÃ©cupÃ©rer avant qu'ils n'expirent !
    </div>
  </div>

  <!-- Alert si aucune rÃ©servation -->
  <div class="alert alert-info" *ngIf="stats && stats.total_reservations === 0">
    <span class="alert-icon">ğŸ“š</span>
    <div class="alert-content">
      <strong>Aucune rÃ©servation.</strong> RÃ©servez un livre indisponible pour Ãªtre notifiÃ© 
      dÃ¨s qu'il devient disponible !
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs-navigation">
    <button 
      class="tab-button"
      [class.active]="activeTab === 'en_attente'"
      (click)="setActiveTab('en_attente')">
      <span class="tab-icon">â³</span>
      <span>En Attente</span>
      <span class="tab-badge" *ngIf="nombreEnAttente > 0">{{ nombreEnAttente }}</span>
    </button>

    <button 
      class="tab-button"
      [class.active]="activeTab === 'disponibles'"
      (click)="setActiveTab('disponibles')">
      <span class="tab-icon">âœ…</span>
      <span>Disponibles</span>
      <span class="tab-badge success" *ngIf="nombreDisponibles > 0">{{ nombreDisponibles }}</span>
    </button>

    <button 
      class="tab-button"
      [class.active]="activeTab === 'toutes'"
      (click)="setActiveTab('toutes')">
      <span class="tab-icon">ğŸ“‹</span>
      <span>Toutes</span>
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Chargement des rÃ©servations...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !loading" class="error-message">
    <span class="error-icon">âš ï¸</span>
    <p>{{ error }}</p>
  </div>

  <!-- Liste des rÃ©servations -->
  <div *ngIf="!loading && !error" class="reservations-list">
    <div *ngIf="reservations.length === 0" class="empty-state">
      <span class="empty-icon">
        {{ activeTab === 'en_attente' ? 'â³' : 
           activeTab === 'disponibles' ? 'âœ…' : 'ğŸ“‹' }}
      </span>
      <h3>{{ activeTab === 'en_attente' ? 'Aucune rÃ©servation en attente' : 
              activeTab === 'disponibles' ? 'Aucune rÃ©servation disponible' : 
              'Aucune rÃ©servation' }}</h3>
      <p>
        {{ activeTab === 'en_attente' ? 'RÃ©servez des livres indisponibles pour Ãªtre notifiÃ© quand ils sont disponibles.' : 
           activeTab === 'disponibles' ? 'Vous n\'avez pas de livres disponibles Ã  rÃ©cupÃ©rer pour le moment.' : 
           'Vous n\'avez aucune rÃ©servation enregistrÃ©e.' }}
      </p>
      <button class="btn btn-primary" routerLink="/livres">
        <span class="btn-icon">ğŸ”</span>
        Parcourir le Catalogue
      </button>
    </div>

    <div class="reservations-grid" *ngIf="reservations.length > 0">
      <div *ngFor="let reservation of reservations" class="reservation-card">
        <!-- Status Badge -->
        <div class="reservation-status" [ngClass]="getStatusClass(reservation.statut)">
          <span class="status-icon">{{ getStatusIcon(reservation.statut) }}</span>
          <span class="status-text">{{ getStatusLabel(reservation.statut) }}</span>
        </div>

        <!-- Livre Info -->
        <div class="reservation-livre">
          <div class="livre-cover">
            <img 
              *ngIf="reservation.livre?.image_url" 
              [src]="reservation.livre.image_url" 
              [alt]="reservation.livre.titre"
              class="cover-img">
            <div *ngIf="!reservation.livre?.image_url" class="cover-placeholder">
              ğŸ“–
            </div>
          </div>

          <div class="livre-info">
            <h3 class="livre-titre">{{ reservation.livre?.titre || 'Titre non disponible' }}</h3>
            <p class="livre-auteur">{{ reservation.livre?.auteur || 'Auteur inconnu' }}</p>
            
            <div class="livre-meta">
              <span class="meta-item">
                <span class="meta-icon">ğŸ“…</span>
                RÃ©servÃ© le {{ formatDate(reservation.date_reservation) }}
              </span>
              
              <span class="meta-item" *ngIf="reservation.statut === 'en_attente'">
                <span class="meta-icon">ğŸ‘¥</span>
                Position: {{ getPositionFile(reservation) }}
              </span>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="reservation-actions">
          <a 
            *ngIf="reservation.statut === 'disponible'"
            routerLink="/livres/{{ reservation.livre?.id }}"
            class="btn btn-success btn-sm">
            <span class="btn-icon">ğŸ‘ï¸</span>
            Voir le Livre
          </a>

          <button 
            *ngIf="reservation.statut === 'en_attente' || reservation.statut === 'disponible'"
            class="btn btn-danger btn-sm"
            (click)="annulerReservation(reservation)">
            <span class="btn-icon">âœ•</span>
            Annuler
          </button>

          <a 
            *ngIf="reservation.statut === 'expiree' || reservation.statut === 'annulee'"
            routerLink="/livres/{{ reservation.livre?.id }}"
            class="btn btn-secondary btn-sm">
            <span class="btn-icon">ğŸ”„</span>
            RÃ©server Ã  nouveau
          </a>
        </div>

        <!-- Alert spÃ©cifique -->
        <div class="reservation-alert" *ngIf="reservation.statut === 'disponible'">
          <span class="alert-icon">âš ï¸</span>
          <p>Ce livre est maintenant disponible ! Passez le rÃ©cupÃ©rer rapidement avant expiration.</p>
        </div>

        <div class="reservation-alert info" *ngIf="reservation.statut === 'en_attente'">
          <span class="alert-icon">ğŸ’¡</span>
          <p>Vous serez notifiÃ© dÃ¨s que ce livre devient disponible.</p>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="totalPages > 1">
      <button 
        class="pagination-btn"
        [disabled]="currentPage === 1"
        (click)="changePage(currentPage - 1)">
        â† PrÃ©cÃ©dent
      </button>

      <div class="pagination-pages">
        <button 
          *ngFor="let page of [].constructor(totalPages); let i = index"
          class="pagination-page"
          [class.active]="currentPage === i + 1"
          (click)="changePage(i + 1)">
          {{ i + 1 }}
        </button>
      </div>

      <button 
        class="pagination-btn"
        [disabled]="currentPage === totalPages"
        (click)="changePage(currentPage + 1)">
        Suivant â†’
      </button>
    </div>
  </div>

  <!-- Info Section -->
  <div class="info-section">
    <h3 class="info-title">
      <span class="info-icon">ğŸ’¡</span>
      Comment fonctionnent les rÃ©servations ?
    </h3>
    <div class="info-grid">
      <div class="info-card">
        <span class="info-emoji">ğŸ”</span>
        <h4>Trouver un livre</h4>
        <p>Parcourez le catalogue et trouvez le livre que vous souhaitez lire.</p>
      </div>

      <div class="info-card">
        <span class="info-emoji">ğŸ“š</span>
        <h4>RÃ©server</h4>
        <p>Si le livre est indisponible, cliquez sur "RÃ©server" pour Ãªtre mis en file d'attente.</p>
      </div>

      <div class="info-card">
        <span class="info-emoji">ğŸ””</span>
        <h4>Notification</h4>
        <p>Vous recevrez une notification dÃ¨s que le livre sera disponible pour vous.</p>
      </div>

      <div class="info-card">
        <span class="info-emoji">â°</span>
        <h4>RÃ©cupÃ©rer</h4>
        <p>Passez Ã  la bibliothÃ¨que dans les 48h pour emprunter le livre rÃ©servÃ©.</p>
      </div>
    </div>
  </div>
</div>